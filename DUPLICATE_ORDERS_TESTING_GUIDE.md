# 重複訂單檢測功能測試指南

## 🧪 測試環境準備

### 1. 啟動開發環境
```bash
# 在 sheet-order-dashboard-main 目錄下執行
npm run dev -- --port 5173
```

### 2. 確認服務運行
- 前端：http://localhost:5173
- 後端 API：確保 XAMPP Apache 服務運行

## 🔍 功能測試步驟

### 測試 1：自動警示功能（首次載入）

#### 步驟：
1. 確保系統中有重複電話號碼的訂單
2. 開啟瀏覽器訪問 http://localhost:5173
3. 登入管理後台
4. 觀察頁面載入完成後的行為

#### 預期結果：
- ✅ 如果有重複訂單，系統會自動彈出警示對話框
- ✅ 對話框標題顯示「⚠️ 重複訂單警示」
- ✅ 對話框背景為紅色主題（警示模式）
- ✅ 顯示「系統檢測到 X 組重複電話，共 Y 筆訂單，請注意檢查！」
- ✅ 底部按鈕顯示「我知道了」
- ✅ 只在首次載入時顯示，重新整理頁面不會再次彈出

### 測試 2：重複訂單按鈕顯示

#### 步驟：
1. 關閉自動警示對話框（如果有）
2. 觀察首頁的操作按鈕區域

#### 預期結果：
- ✅ 在篩選訂單數量與列印訂單按鈕之間顯示「重複訂單(X)」按鈕
- ✅ 按鈕為黃色邊框，帶有警告圖示 ⚠️
- ✅ 括號內顯示重複訂單的總數量
- ✅ 按鈕樣式與其他操作按鈕一致

### 測試 3：電話號碼重複警示

#### 步驟：
1. 在訂單列表中查看各筆訂單的客戶資訊
2. 觀察電話號碼欄位

#### 預期結果：
- ✅ 有重複電話號碼的訂單，在電話號碼後顯示紅色警告圖示 ⚠️
- ✅ 滑鼠懸停在警告圖示上顯示「重複電話號碼」提示
- ✅ 沒有重複電話號碼的訂單不顯示警告圖示

### 測試 4：手動查看重複訂單對話框

#### 步驟：
1. 點擊「重複訂單(X)」按鈕
2. 觀察彈出的對話框

#### 預期結果：
- ✅ 彈出重複訂單檢測結果對話框
- ✅ 對話框標題顯示「重複訂單檢測結果」（非警示模式）
- ✅ 對話框背景為黃色主題（查詢模式）
- ✅ 顯示發現的重複電話群組數量和總訂單數
- ✅ 按電話號碼分組顯示重複訂單
- ✅ 每個群組顯示電話號碼和重複數量標籤
- ✅ 底部按鈕顯示「關閉」

### 測試 5：對話框模式差異

#### 步驟：
1. 比較自動警示對話框和手動查看對話框
2. 觀察兩者的視覺差異

#### 預期結果：
- ✅ 自動警示：紅色主題、「⚠️ 重複訂單警示」標題、「我知道了」按鈕
- ✅ 手動查看：黃色主題、「重複訂單檢測結果」標題、「關閉」按鈕
- ✅ 內容區域完全相同，只有標題和按鈕不同

### 測試 6：查看詳情功能

#### 步驟：
1. 開啟重複訂單對話框（自動或手動）
2. 在任一重複訂單群組中點擊「查看詳情」按鈕
3. 觀察系統反應

#### 預期結果：
- ✅ 重複訂單對話框自動關閉
- ✅ 開啟對應訂單的詳細資訊對話框
- ✅ 顯示完整的訂單資訊（客戶、商品、金額等）
- ✅ 可以在詳情頁面進行編輯操作
- ✅ 如果訂單不存在，顯示錯誤提示

### 測試 7：重複訂單詳細資訊

#### 步驟：
1. 在重複訂單對話框中查看各個群組
2. 觀察每筆重複訂單的詳細資訊

#### 預期結果：
- ✅ 顯示訂單編號（格式化顯示）
- ✅ 顯示客戶姓名
- ✅ 顯示原始電話號碼
- ✅ 按重複數量降序排列群組
- ✅ 每個群組內的訂單清楚標示

### 測試 5：無重複訂單情況

#### 步驟：
1. 如果系統中沒有重複電話號碼的訂單
2. 點擊「重複訂單(0)」按鈕

#### 預期結果：
- ✅ 按鈕顯示「重複訂單(0)」
- ✅ 對話框顯示「沒有發現重複訂單」訊息
- ✅ 顯示綠色圖示和說明文字

### 測試 6：電話號碼標準化邏輯

#### 測試資料：
準備以下格式的電話號碼進行測試：
- `0912345678`
- `912345678`
- `09-1234-5678`
- `0912-345-678`
- `+886912345678`

#### 預期結果：
- ✅ 所有格式都能正確識別為同一個電話號碼
- ✅ 比對時使用後9碼邏輯
- ✅ 忽略特殊符號和國碼前綴

### 測試 7：即時更新機制

#### 步驟：
1. 記錄當前重複訂單數量
2. 新增一筆與現有訂單相同電話號碼的訂單
3. 觀察重複訂單按鈕的數量變化

#### 預期結果：
- ✅ 新增訂單後，重複訂單數量自動更新
- ✅ 新訂單在列表中顯示警告圖示
- ✅ 重複訂單對話框中包含新訂單

### 測試 8：刪除訂單後的更新

#### 步驟：
1. 刪除一筆重複訂單
2. 觀察重複訂單數量和警示的變化

#### 預期結果：
- ✅ 刪除後重複訂單數量自動更新
- ✅ 如果某個電話號碼只剩一筆訂單，警示消失
- ✅ 重複訂單對話框中的資訊同步更新

## 🎯 測試重點

### 電話號碼比對邏輯
- 測試各種電話號碼格式的正確識別
- 驗證後9碼比對邏輯的準確性
- 確認特殊符號和前綴的正確處理

### 用戶體驗
- 重複訂單警示清楚明顯
- 對話框資訊完整易懂
- 操作流程直觀簡單

### 即時性
- 訂單變更時重複檢測自動更新
- 數量統計準確無誤
- 警示狀態即時反映

## 🐛 常見問題排除

### 問題 1：重複訂單按鈕不顯示
**解決方案**：檢查瀏覽器控制台是否有 JavaScript 錯誤

### 問題 2：警告圖示不顯示
**解決方案**：
- 確認訂單資料中有重複的電話號碼
- 檢查電話號碼格式是否正確

### 問題 3：對話框不開啟
**解決方案**：檢查瀏覽器控制台是否有組件載入錯誤

### 問題 4：重複檢測不準確
**解決方案**：
- 檢查電話號碼標準化邏輯
- 確認後9碼比對算法正確

## 📊 測試檢查清單

- [ ] 重複訂單按鈕正確顯示
- [ ] 按鈕數量統計準確
- [ ] 電話號碼警示正常顯示
- [ ] 重複訂單對話框功能完整
- [ ] 電話號碼標準化邏輯正確
- [ ] 即時更新機制運作正常
- [ ] 無重複訂單時顯示正確
- [ ] 用戶體驗流暢直觀

## 🚀 下一步

測試完成後，建議：
1. 記錄任何發現的問題
2. 驗證修復後的功能
3. 測試大量資料的效能表現
4. 更新用戶使用手冊

---
**注意**：測試時建議使用真實的訂單資料，以確保電話號碼比對邏輯的準確性！
