# 批次刪除訂單功能測試指南

## 🧪 測試環境準備

### 1. 啟動開發環境
```bash
# 在 sheet-order-dashboard-main 目錄下執行
npm run dev -- --port 5173
```

### 2. 確認服務運行
- 前端：http://localhost:5173
- 後端 API：確保 XAMPP Apache 服務運行

## 🔍 功能測試步驟

### 測試 1：批次刪除按鈕顯示

#### 步驟：
1. 開啟瀏覽器訪問 http://localhost:5173
2. 登入管理後台
3. 在訂單列表中勾選一個或多個訂單
4. 觀察批次操作區域

#### 預期結果：
- ✅ 選擇訂單後，批次操作區域出現
- ✅ 顯示「批次刪除 (X)」按鈕，X為選中的訂單數量
- ✅ 按鈕為紅色，具有垃圾桶圖示
- ✅ 按鈕樣式與其他批次操作按鈕一致

### 測試 2：批次刪除確認對話框

#### 步驟：
1. 選擇 2-3 筆訂單
2. 點擊「批次刪除」按鈕
3. 觀察確認對話框

#### 預期結果：
- ✅ 彈出批次刪除確認對話框
- ✅ 對話框標題顯示「批次刪除訂單確認」
- ✅ 顯示警告圖示和警告文字
- ✅ 列出將要刪除的訂單詳情（訂單編號、客戶姓名、商品摘要、總金額）
- ✅ 顯示重要提醒和警告訊息
- ✅ 有「取消」和「確認刪除 X 筆訂單」按鈕

### 測試 3：取消刪除操作

#### 步驟：
1. 開啟批次刪除確認對話框
2. 點擊「取消」按鈕或右上角的 X 按鈕

#### 預期結果：
- ✅ 對話框關閉
- ✅ 訂單選擇狀態保持不變
- ✅ 沒有執行任何刪除操作

### 測試 4：執行批次刪除

#### 步驟：
1. 選擇 1-2 筆測試訂單（建議選擇測試資料）
2. 點擊「批次刪除」按鈕
3. 在確認對話框中點擊「確認刪除」按鈕
4. 觀察處理過程和結果

#### 預期結果：
- ✅ 確認按鈕顯示載入狀態「刪除中...」
- ✅ 按鈕在處理期間被禁用
- ✅ 刪除完成後顯示成功提示訊息
- ✅ 對話框自動關閉
- ✅ 訂單列表自動重新整理
- ✅ 被刪除的訂單從列表中消失
- ✅ 選擇狀態被清除

### 測試 5：錯誤處理

#### 步驟：
1. 暫時停止 XAMPP Apache 服務
2. 嘗試執行批次刪除操作

#### 預期結果：
- ✅ 顯示錯誤提示訊息
- ✅ 對話框保持開啟狀態
- ✅ 按鈕恢復可用狀態
- ✅ 用戶可以重試或取消操作

### 測試 6：無選擇訂單時的行為

#### 步驟：
1. 確保沒有選擇任何訂單
2. 觀察批次操作區域

#### 預期結果：
- ✅ 批次操作區域不顯示
- ✅ 沒有批次刪除按鈕

### 測試 7：Google Sheets 同步驗證

#### 步驟：
1. 執行批次刪除操作
2. 檢查 Google Sheets 中的資料
3. 執行 ID 重新排序驗證腳本

#### 預期結果：
- ✅ 對應的訂單行已從 Google Sheets 中刪除
- ✅ 後續訂單的 ID 已重新排序（N欄）
- ✅ 資料一致性保持完整

#### ID 重新排序驗證：
```bash
# 在專案根目錄執行
php test_batch_delete_id_reorder.php
```

此腳本會檢查：
- N欄的ID是否與行索引一致
- 是否有ID錯誤的訂單
- 提供詳細的檢查報告

## 🎯 測試重點

### 用戶體驗
- 操作流程直觀易懂
- 確認對話框提供充分的資訊
- 載入狀態清楚顯示
- 錯誤訊息明確有用

### 安全性
- 二次確認機制有效
- 無法意外觸發刪除
- 錯誤處理完善

### 功能性
- 批次刪除正確執行
- Google Sheets 同步正常
- 快取清除機制運作
- ID 重新排序正確

## 🐛 常見問題排除

### 問題 1：批次刪除按鈕不顯示
**解決方案**：確認已選擇至少一筆訂單

### 問題 2：確認對話框不開啟
**解決方案**：檢查瀏覽器控制台是否有 JavaScript 錯誤

### 問題 3：刪除操作失敗
**解決方案**：
- 檢查 XAMPP Apache 服務是否運行
- 確認 Google Sheets API 憑證是否有效
- 檢查網路連接

### 問題 4：Google Sheets 資料未同步
**解決方案**：
- 檢查 API 權限設定
- 確認 service-account-key2.json 檔案存在
- 檢查後端 PHP 錯誤日誌

## 📊 測試檢查清單

- [ ] 批次刪除按鈕正確顯示
- [ ] 確認對話框功能完整
- [ ] 取消操作正常運作
- [ ] 刪除操作成功執行
- [ ] 錯誤處理機制有效
- [ ] Google Sheets 同步正確
- [ ] 用戶體驗流暢
- [ ] 安全機制完善

## 🚀 下一步

測試完成後，建議：
1. 記錄任何發現的問題
2. 驗證修復後的功能
3. 進行壓力測試（大量訂單批次刪除）
4. 更新用戶使用手冊

---
**注意**：測試時請使用測試資料，避免刪除重要的生產資料！
